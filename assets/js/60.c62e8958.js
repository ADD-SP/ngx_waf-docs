(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{389:function(_,v,a){"use strict";a.r(v);var t=a(25),e=Object(t.a)({},(function(){var _=this,v=_._self._c;return v("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[v("h1",{attrs:{id:"内置变量"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#内置变量"}},[_._v("#")]),_._v(" 内置变量")]),_._v(" "),v("p",[_._v("在书写 nginx.conf 文件的时候不可避免地需要用到一些变量，如"),v("code",[_._v("$remote_addr")]),_._v("可以用来获取客户端 IP 地址。")]),_._v(" "),v("p",[_._v("本模块增加了多个可用的变量。")]),_._v(" "),v("div",{staticClass:"custom-block warning"},[v("p",{staticClass:"custom-block-title"},[_._v("不能和指令 `if` 共用")]),_._v(" "),v("p",[_._v("详见"),v("RouterLink",{attrs:{to:"/zh-cn/guide/faq.html#模块的内置变量与指令-if"}},[_._v("常见问题与解答")]),_._v("。")],1)]),_._v(" "),v("h2",{attrs:{id:"waf-log"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#waf-log"}},[_._v("#")]),_._v(" "),v("code",[_._v("$waf_log")])]),_._v(" "),v("p",[_._v("如果本次请求中防火墙进行了检查则不为空字符串，反之为空字符串。本变量主要用于 "),v("code",[_._v("access_log")]),_._v(" 指令，详见 "),v("RouterLink",{attrs:{to:"/zh-cn/advance/log.html#自定义日志格式"}},[_._v("自定义日志格式")]),_._v("。")],1),_._v(" "),v("h2",{attrs:{id:"waf-blocking-log"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#waf-blocking-log"}},[_._v("#")]),_._v(" "),v("code",[_._v("$waf_blocking_log")])]),_._v(" "),v("p",[_._v("如果本次请求本被模块拦截则不为空字符串，反之则为空字符串。本变量主要用于 "),v("code",[_._v("access_log")]),_._v(" 指令，详见 "),v("RouterLink",{attrs:{to:"/zh-cn/advance/log.html#自定义日志格式"}},[_._v("自定义日志格式")]),_._v("。")],1),_._v(" "),v("h2",{attrs:{id:"waf-blocked"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#waf-blocked"}},[_._v("#")]),_._v(" "),v("code",[_._v("$waf_blocked")])]),_._v(" "),v("p",[_._v("表示本次请求是否被本模块拦截，如果拦截了则其的值为"),v("code",[_._v("'true'")]),_._v(",反之则为"),v("code",[_._v("'false'")]),_._v("。")]),_._v(" "),v("h2",{attrs:{id:"waf-spend"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#waf-spend"}},[_._v("#")]),_._v(" "),v("code",[_._v("$waf_spend")])]),_._v(" "),v("p",[_._v("表示本次检查花费了多少时间（毫秒），保留 5 位小数，舍入规则取决于具体 C 标准库的实现。")]),_._v(" "),v("h2",{attrs:{id:"waf-rule-type"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#waf-rule-type"}},[_._v("#")]),_._v(" "),v("code",[_._v("$waf_rule_type")])]),_._v(" "),v("p",[_._v("如果本次请求命中黑白名单规则，则其值为触发的规则类型。下面是可能的取值。若没有命中黑白名单规则则其值为"),v("code",[_._v("''")]),_._v("。")]),_._v(" "),v("ul",[v("li",[v("code",[_._v("'CC-DENY'")])]),_._v(" "),v("li",[v("code",[_._v("'WHITE-IPV4'")])]),_._v(" "),v("li",[v("code",[_._v("'WHITE-IPV6'")])]),_._v(" "),v("li",[v("code",[_._v("'BLACK-IPV4'")])]),_._v(" "),v("li",[v("code",[_._v("'BLACK-IPV6'")])]),_._v(" "),v("li",[v("code",[_._v("'WHITE-URL'")])]),_._v(" "),v("li",[v("code",[_._v("'BLACK-URL'")])]),_._v(" "),v("li",[v("code",[_._v("'BLACK-ARGS'")])]),_._v(" "),v("li",[v("code",[_._v("'BLACK-USER-AGENT'")])]),_._v(" "),v("li",[v("code",[_._v("'WHITE-REFERER'")])]),_._v(" "),v("li",[v("code",[_._v("'BLACK-REFERER'")])]),_._v(" "),v("li",[v("code",[_._v("'BLACK-COOKIE'")])]),_._v(" "),v("li",[v("code",[_._v("'BLACK-POST'")])]),_._v(" "),v("li",[v("code",[_._v("'UNDER-ATTACK'")])]),_._v(" "),v("li",[v("code",[_._v("'FAKE-BOT'")])]),_._v(" "),v("li",[v("code",[_._v("'CAPTCHA'")])])]),_._v(" "),v("h2",{attrs:{id:"waf-rule-details"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#waf-rule-details"}},[_._v("#")]),_._v(" "),v("code",[_._v("$waf_rule_details")])]),_._v(" "),v("p",[_._v("如果本次请求被本模块拦截，则其值为触发的具体的规则的内容。若没有生效则其值为"),v("code",[_._v("''")]),_._v("。")]),_._v(" "),v("h2",{attrs:{id:"waf-rate"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#waf-rate"}},[_._v("#")]),_._v(" "),v("code",[_._v("$waf_rate")])]),_._v(" "),v("p",[_._v("一个整数，表示一个统计周期内当前 IP 的访问次数。")])])}),[],!1,null,null,null);v.default=e.exports}}]);